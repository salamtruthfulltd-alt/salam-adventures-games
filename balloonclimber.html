<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spell Stack: Skyward 20</title>
    <style>
        :root { 
            --neon: #00f2ff; --gold: #ffcc00; --wood: #5D4037;
            --sky-top: #020111; --sky-bot: #3a1c71;
        }
        
        body { 
            margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(180deg, var(--sky-top) 0%, var(--sky-bot) 100%);
            color: white; display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; overflow: hidden;
        }

        /* BACKGROUND DECORATIONS */
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; background: url('https://www.transparenttextures.com/patterns/stardust.png'); opacity: 0.3; }
        
        #city-silhouette {
            position: fixed; bottom: 0; width: 100%; height: 200px;
            background: linear-gradient(transparent, #000); z-index: -1;
        }
        .building {
            position: absolute; bottom: 0; background: #050505; width: 60px;
        }

        /* HUD */
        .hud { 
            display: flex; gap: 30px; background: rgba(0,0,0,0.8);
            padding: 10px 40px; border-radius: 0 0 30px 30px;
            border: 2px solid var(--neon); border-top: none;
            box-shadow: 0 0 20px var(--neon); z-index: 10;
        }
        .stat { text-align: center; }
        .label { font-size: 0.7rem; color: #888; text-transform: uppercase; }
        .val { font-size: 1.4rem; color: var(--neon); font-weight: bold; }

        /* THE TOWER FRAME */
        #tower-frame {
            width: 300px; height: 400px;
            background: rgba(10, 10, 25, 0.7); border: 8px solid var(--wood);
            border-radius: 10px; position: relative; margin-top: 20px;
            display: flex; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.9);
        }

        #selection-zone {
            height: 60px; border-bottom: 2px dashed var(--neon);
            display: flex; justify-content: space-around; align-items: center;
            font-size: 1.8rem; color: var(--gold); font-weight: 900;
        }

        #stack { flex-grow: 1; display: flex; flex-direction: column-reverse; padding: 5px; }
        .brick {
            height: 32px; margin: 1px 0; border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; color: #000; font-size: 0.8rem;
            animation: drop 0.3s ease-out; border: 1px solid rgba(255,255,255,0.2);
        }
        @keyframes drop { from { transform: translateY(-300px); } to { transform: translateY(0); } }

        /* OVERLAYS */
        #menu-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 20;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .start-btn {
            padding: 15px 40px; font-size: 1.5rem; font-weight: bold;
            background: #2ecc71; color: white; border: none; border-radius: 10px;
            cursor: pointer; box-shadow: 0 5px 0 #27ae60; transition: 0.1s;
        }
        .start-btn:active { transform: translateY(3px); box-shadow: 0 2px 0 #27ae60; }

        /* INPUT AREA */
        #puzzle-display { font-size: 2.8rem; margin: 15px 0; font-weight: 900; letter-spacing: 4px; }
        #answer-input { 
            font-size: 1.5rem; width: 250px; padding: 10px; border-radius: 10px;
            border: 3px solid var(--neon); background: #000; color: white; text-align: center;
        }

        #leaderboard {
            margin-top: 20px; width: 300px; background: white; color: #333;
            border-radius: 10px; padding: 10px; max-height: 150px; overflow-y: auto;
        }
        .row { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; font-size: 0.8rem; padding: 3px; }
    </style>
</head>
<body>

    <div class="stars"></div>
    <div id="city-silhouette"></div>

    <div class="hud">
        <div class="stat"><div class="label">Time</div><div class="val" id="t">60</div></div>
        <div class="stat"><div class="label">Score</div><div class="val" id="s">0</div></div>
        <div class="stat"><div class="label">Floor</div><div class="val" id="f">1</div></div>
    </div>

    <div id="tower-frame">
        <div id="menu-overlay">
            <h2 style="color:var(--gold); margin-bottom: 20px;">SKYWARD 20</h2>
            <button class="start-btn" onclick="startGame()">START BUILDING</button>
        </div>
        <div id="selection-zone">
            <span id="opt1"></span><span id="opt2"></span><span id="opt3"></span>
        </div>
        <div id="stack"></div>
    </div>

    <div id="puzzle-display">---</div>
    <input type="text" id="answer-input" placeholder="Type letter..." disabled>

    <div id="leaderboard">
        <h4 style="margin:0; text-align:center;">üèÜ TOP 20 ARCHITECTS</h4>
        <div id="list"></div>
    </div>

<script>
    const data = [
        {w: "GRAPE", m: "G_APE", a: "R"}, {w: "MOUSE", m: "MO_SE", a: "U"},
        {w: "PLANE", m: "PL_NE", a: "A"}, {w: "BREAD", m: "BR_AD", a: "E"},
        {w: "CLOCK", m: "CLO_K", a: "C"}, {w: "FLOWER", m: "FLO_ER", a: "W"},
        {w: "TIGER", m: "TI_ER", a: "G"}, {w: "SNAKE", m: "SN_KE", a: "A"}
    ];
    
    let state = { score: 0, time: 60, floor: 1, count: 0, active: false, cur: {} };
    let clock;

    // Build city silhouette
    for(let i=0; i<20; i++) {
        let b = document.createElement('div');
        b.className = 'building';
        b.style.left = (i * 45) + 'px';
        b.style.height = (Math.random() * 100 + 50) + 'px';
        b.style.opacity = Math.random() * 0.5 + 0.5;
        document.getElementById('city-silhouette').appendChild(b);
    }

    function renderBoard() {
        let scores = JSON.parse(localStorage.getItem('skyward20_v2') || '[]');
        document.getElementById('list').innerHTML = scores.map((x, i) => 
            `<div class="row"><span>${i+1}. ${x.n}</span><span>${x.s}</span></div>`).join('');
    }

    function startGame() {
        state.active = true;
        state.score = 0; state.time = 60; state.floor = 1; state.count = 0;
        document.getElementById('menu-overlay').style.display = 'none';
        document.getElementById('answer-input').disabled = false;
        document.getElementById('answer-input').focus();
        document.getElementById('stack').innerHTML = '';
        updateStats();
        
        clock = setInterval(() => {
            state.time--;
            document.getElementById('t').innerText = state.time;
            if(state.time <= 0) endGame();
        }, 1000);
        
        next();
    }

    function next() {
        state.cur = data[Math.floor(Math.random() * data.length)];
        document.getElementById('puzzle-display').innerText = state.cur.m;
        
        let opts = [state.cur.a];
        while(opts.length < 3) {
            let r = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)];
            if(!opts.includes(r)) opts.push(r);
        }
        opts.sort(() => Math.random() - 0.5);
        document.getElementById('opt1').innerText = opts[0];
        document.getElementById('opt2').innerText = opts[1];
        document.getElementById('opt3').innerText = opts[2];
    }

    document.getElementById('answer-input').addEventListener('input', (e) => {
        if(!state.active) return;
        if(e.target.value.toUpperCase() === state.cur.a) {
            e.target.value = '';
            addBrick();
        }
    });

    function addBrick() {
        state.score += 100;
        state.count++;
        updateStats();
        
        let b = document.createElement('div');
        b.className = 'brick';
        b.innerText = state.cur.w;
        const colors = ['#00f2ff', '#ff00de', '#7cfc00', '#ff8c00'];
        b.style.backgroundColor = colors[(state.floor-1) % 4];
        document.getElementById('stack').appendChild(b);

        if(state.count >= 10) {
            state.floor++;
            state.count = 0;
            state.time += 10;
            document.getElementById('stack').innerHTML = '';
            updateStats();
        }
        next();
    }

    function updateStats() {
        document.getElementById('s').innerText = state.score;
        document.getElementById('f').innerText = state.floor;
    }

    function endGame() {
        clearInterval(clock);
        state.active = false;
        document.getElementById('answer-input').disabled = true;
        let n = prompt("TOWER COMPLETE! Score: " + state.score + "\nEnter Name:");
        if(n) {
            let scores = JSON.parse(localStorage.getItem('skyward20_v2') || '[]');
            scores.push({n: n.toUpperCase().substring(0,10), s: state.score});
            scores.sort((a,b) => b.s - a.s);
            localStorage.setItem('skyward20_v2', JSON.stringify(scores.slice(0, 20)));
        }
        location.reload();
    }

    renderBoard();
</script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>Magic Tap: Ultra Pro Max</title>
  <style>
    :root {
      --rainbow: linear-gradient(90deg, #ff0000, #ffea00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000);
      --plastic: #fdfcfd;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
    
    body { 
      margin: 0; padding: 20px; background: #cbd5e1; 
      font-family: 'Comic Sans MS', 'Rounded Mplus 1c', sans-serif;
      display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden;
    }

    /* THE MASSIVE 3D HARDWARE CONSOLE */
    .toy-body {
      width: 100%; max-width: 1100px; height: 95vh;
      background: var(--plastic); border-radius: 70px;
      position: relative; padding: 25px;
      /* Massive 3D Depth */
      box-shadow: 
        0 15px 0 #94a3b8, 
        0 40px 60px rgba(0,0,0,0.3),
        inset 0 -10px 10px rgba(0,0,0,0.05),
        inset 0 10px 10px rgba(255,255,255,0.8);
      display: flex; flex-direction: column;
    }

    /* NEON GLOW TUBE */
    .glow-ring {
      position: absolute; inset: 10px; border-radius: 65px;
      padding: 6px; background: var(--rainbow); background-size: 200% 200%;
      animation: neonMove 5s linear infinite;
      z-index: 0;
    }
    @keyframes neonMove { 0%{background-position:0% 50%} 100%{background-position:200% 50%} }

    .screen-recess {
      background: #ffffff; border-radius: 50px; flex: 1;
      position: relative; z-index: 1; display: flex; flex-direction: column;
      box-shadow: inset 0 15px 30px rgba(0,0,0,0.2);
      border: 10px solid #e2e8f0; overflow: hidden;
    }

    header {
      padding: 15px 40px; background: #fff; border-bottom: 2px solid #f1f5f9;
      display: flex; justify-content: space-between; align-items: center;
    }

    /* ART VIEWPORT */
    .canvas { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; background: #fff; }
    svg { width: 100%; height: 100%; max-height: 52vh; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.08)); }
    
    /* PRO SVG LINES */
    .p { fill: #fff; stroke: #1e293b; stroke-width: 3.2; stroke-linecap: round; stroke-linejoin: round; cursor: pointer; transition: fill 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .p:hover { stroke: #3b82f6; stroke-width: 4.5; }
    .bg-lines { fill: none; stroke: #cbd5e1; stroke-width: 1.5; pointer-events: none; }

    /* RECESSED CONTROL PANEL */
    .control-panel {
      background: #f8fafc; padding: 25px; border-top: 4px solid #e2e8f0;
      display: flex; flex-direction: column; align-items: center; gap: 20px;
    }
    .swatches { display: flex; gap: 15px; overflow-x: auto; width: 100%; justify-content: center; padding: 10px; }
    .swatch {
      min-width: 60px; height: 60px; border-radius: 20px; border: 5px solid white;
      cursor: pointer; box-shadow: 0 8px 0 #cbd5e1, 0 10px 20px rgba(0,0,0,0.1);
      transition: 0.1s;
    }
    .swatch:active { transform: translateY(4px); box-shadow: 0 4px 0 #cbd5e1; }
    .swatch.active { border-color: #1e293b; transform: scale(1.1) translateY(4px); box-shadow: 0 4px 0 #cbd5e1; }

    .toy-btn {
      padding: 15px 30px; border: none; border-radius: 25px; font-weight: 900; 
      font-size: 16px; cursor: pointer; text-transform: uppercase;
      background: #fff; box-shadow: 0 6px 0 #e2e8f0; color: #475569;
    }
    .toy-btn:active { transform: translateY(3px); box-shadow: 0 3px 0 #e2e8f0; }
    .btn-action { background: #3b82f6; color: white; box-shadow: 0 6px 0 #1d4ed8; }

    #gallery { position: absolute; inset: 0; background: white; z-index: 100; padding: 40px; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    .hidden { display: none !important; }
  </style>
</head>
<body>

<div class="toy-body">
  <div class="glow-ring"></div>
  <div class="screen-recess">
    <header>
      <div style="font-size:28px; font-weight:900; color:#1e293b;">âœ¨ MAGIC TAP <small style="color:#3b82f6">ULTRA</small></div>
      <button class="toy-btn btn-action" onclick="showGal()">ðŸŽ¨ NEW IMAGE</button>
    </header>

    <div id="gallery" class="hidden"></div>
    <div class="canvas" id="stage"></div>

    <div class="control-panel">
      <div class="swatches" id="palette"></div>
      <div style="display:flex; gap:20px">
        <button class="toy-btn" onclick="clearArt()">ðŸ§¼ CLEAR</button>
        <button class="toy-btn" onclick="toggleMusic()" id="m-btn">ðŸŽµ MUSIC: OFF</button>
      </div>
    </div>
  </div>
</div>

<script>
  const COLORS = ['#FF4B4B', '#FF9F43', '#FECA57', '#1DD1A1', '#48DBFB', '#54A0FF', '#5F27CD', '#FF9FF3', '#222f3e', '#FFFFFF'];
  let currentInk = COLORS[0], aCtx = null, musOn = false;

  const SCENES = [
    { name: "Sunny Garden", svg: `
      <path class="bg-lines" d="M0 550 q400-80 800 0"/>
      <path class="p" d="M380 400 v180 h40 v-180 z"/>
      <path class="p" d="M400 300 m-80,0 a80,80 0 1,0 160,0 a80,80 0 1,0 -160,0"/>
      <path class="p" d="M400 220 q80-100 150 0 t-150 80"/> <path class="p" d="M400 220 q-80-100-150 0 t150 80"/>
      <path class="p" d="M480 300 q100-80 100 80 t-180 0"/> <path class="p" d="M320 300 q-100-80-100 80 t180 0"/>
      <path class="p" d="M400 380 q80 100 150 0 t-150-80"/> <path class="p" d="M400 380 q-80 100-150 0 t150-80"/>
      <path class="p" d="M650 100 m-40,0 a40,40 0 1,0 80,0 a40,40 0 1,0 -80,0"/>
      <path class="bg-lines" d="M650 40 v40 M690 100 h40 M650 140 v40 M610 100 h40"/>
    `},
    { name: "Deep Sea Fish", svg: `
      <path class="p" d="M200 350 q200-250 500 0 c150 150 0 250-100 100 l120 120 v-240 l-120 120 q-250 150-400-100 z"/>
      <path class="p" d="M450 240 q50-80 100 0"/> <path class="p" d="M450 460 q50 80 100 0"/>
      <circle class="p" cx="300" cy="320" r="25"/> <circle class="p" cx="310" cy="310" r="8" fill="#000"/>
      <circle class="p" cx="150" cy="180" r="20"/> <circle class="p" cx="100" cy="100" r="35"/>
      <path class="p" d="M600 500 q20-100 80-100 t20 100 t-80 100 t-20-100"/>
    `},
    { name: "Royal Castle", svg: `
      <path class="p" d="M150 550 h500 v-280 h-500 z"/>
      <path class="p" d="M180 270 v-180 h120 v180 z"/> <path class="p" d="M500 270 v-180 h120 v180 z"/>
      <path class="p" d="M165 90 l75-90 l75 90 z"/> <path class="p" d="M485 90 l75-90 l75 90 z"/>
      <path class="p" d="M340 550 v-160 q60-90 120 0 v160 z"/>
      <rect class="p" x="210" y="320" width="60" height="70" rx="10"/>
      <rect class="p" x="530" y="320" width="60" height="70" rx="10"/>
      <path class="bg-lines" d="M150 400 h500 M150 480 h500"/>
    `},
    { name: "Rocket Journey", svg: `
      <path class="p" d="M400 40 c150 0 150 400 150 500 h-300 c0-100 0-500 150-500 z"/>
      <circle class="p" cx="400" cy="230" r="70"/> <circle class="p" cx="400" cy="230" r="45"/>
      <path class="p" d="M280 480 l-130 130 h130 z"/> <path class="p" d="M520 480 l130 130 h-130 z"/>
      <path class="p" d="M150 150 l20-20 l20 20 l-20 20 z"/>
      <path class="p" d="M700 80 l35-35 l35 35 l-35 35 z"/>
      <path class="p" d="M100 400 q60-80 120 0 t120 0 t120 0 h-360 z"/>
      <path class="p" d="M650 300 l15-15 l15 15 l-15 15 z"/>
    `}
  ];

  function init() {
    const pal = document.getElementById('palette');
    COLORS.forEach(c => {
      const s = document.createElement('div');
      s.className = 'swatch' + (c === currentInk ? ' active' : '');
      s.style.backgroundColor = c;
      s.onclick = () => {
        document.querySelectorAll('.swatch').forEach(x => x.classList.remove('active'));
        s.classList.add('active');
        currentInk = c;
        playPop(600, 0.1);
      };
      pal.appendChild(s);
    });

    const gal = document.getElementById('gallery');
    SCENES.forEach((s, i) => {
      const c = document.createElement('div');
      c.className = "toy-btn"; c.style.height = "160px";
      c.innerHTML = `<svg viewBox="0 0 800 600">${s.svg}</svg><p>${s.name}</p>`;
      c.onclick = () => loadScene(i);
      gal.appendChild(c);
    });
    loadScene(0);
  }

  function loadScene(idx) {
    const stage = document.getElementById('stage');
    stage.innerHTML = `<svg viewBox="0 0 800 600" id="art">${SCENES[idx].svg}</svg>`;
    document.getElementById('gallery').classList.add('hidden');
    stage.querySelectorAll('.p').forEach(part => {
      part.onclick = (e) => { e.stopPropagation(); part.style.fill = currentInk; playHiss(); };
    });
  }

  function showGal() { document.getElementById('gallery').classList.remove('hidden'); }
  function clearArt() { document.querySelectorAll('#art .p').forEach(p => p.style.fill = "#fff"); }

  function getA() {
    if (!aCtx) aCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (aCtx.state === 'suspended') aCtx.resume();
    return aCtx;
  }

  function playPop(f, d) {
    const c = getA();
    const o = c.createOscillator(); const g = c.createGain();
    o.frequency.value = f; g.gain.setValueAtTime(0.1, c.currentTime);
    g.gain.exponentialRampToValueAtTime(0.01, c.currentTime + d);
    o.connect(g); g.connect(c.destination);
    o.start(); o.stop(c.currentTime + d);
  }

  function playHiss() {
    const c = getA();
    const b = c.createBuffer(1, c.sampleRate * 0.1, c.sampleRate);
    const d = b.getChannelData(0);
    for (let i = 0; i < b.length; i++) d[i] = Math.random() * 2 - 1;
    const s = c.createBufferSource(); s.buffer = b;
    const f = c.createBiquadFilter(); f.type = 'lowpass'; f.frequency.value = 800;
    const g = c.createGain(); g.gain.setValueAtTime(0.04, c.currentTime);
    g.gain.linearRampToValueAtTime(0, c.currentTime + 0.1);
    s.connect(f); f.connect(g); g.connect(c.destination);
    s.start();
  }

  function toggleMusic() {
    getA(); musOn = !musOn;
    document.getElementById('m-btn').innerText = musOn ? "ðŸŽµ MUSIC: ON" : "ðŸŽµ MUSIC: OFF";
    if (musOn) playLoop();
  }

  function playLoop() {
    if (!musOn) return;
    playPop([261, 329, 392, 523][Math.floor(Math.random()*4)], 1.5);
    setTimeout(playLoop, 800);
  }

  init();
</script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Colouring Generator | Salam Adventures</title>

<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  margin:0;
  background:#fafafa;
}
header{
  padding:20px;
  background:#fff;
  border-bottom:1px solid #eee;
}
main{
  padding:20px;
  max-width:1100px;
  margin:auto;
}
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:15px;
}
button,select{
  padding:10px 14px;
  border-radius:8px;
  border:1px solid #ddd;
  cursor:pointer;
}
button{
  background:#111;
  color:#fff;
}
button.secondary{
  background:#fff;
  color:#111;
}
.canvasWrap{
  background:#fff;
  padding:15px;
  border-radius:14px;
  border:1px solid #ddd;
}
canvas{
  display:block;
  margin:auto;
  background:#fff;
}
</style>
</head>

<body>

<header>
<h2>Colouring Page Generator</h2>
</header>

<main>

<div class="controls">
<select id="picker"></select>
<button id="btnLoad">Load</button>
<button id="btnRandom" class="secondary">Random</button>
<button id="btnDownload" class="secondary">Download</button>
<button id="btnPrint" class="secondary">Print</button>
</div>

<div class="canvasWrap">
<canvas id="c" width="1240" height="1754"></canvas>
</div>

</main>

<script>
const BASE_RAW =
"https://raw.githubusercontent.com/salamtruthfulltd-alt/salam-adventures-games/main/colouring%20images/";

const FILES = [
"butterfly.png.jpg",
"car.png.jpg",
"dinosaur.png",
"dog1.png",
"dolly.png",
"flower design.png",
"fruit and veg.png",
"garden.png",
"horse.png",
"house.png",
"mobile phone.png",
"moon (2).png",
"planes.png",
"prince and princess.png",
"swans.png.jpg",
"tresure chest.png"
];

const picker = document.getElementById("picker");
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

FILES.forEach(f=>{
  const opt=document.createElement("option");
  opt.value=f;
  opt.textContent=f.replace(/\.(png|jpg|jpeg)$/i,"");
  picker.appendChild(opt);
});
picker.value = FILES[0];

function clearWhite(){
  ctx.fillStyle="#fff";
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

function drawBorder(){
  const margin=80;
  ctx.lineWidth=14;
  ctx.strokeStyle="#000";
  ctx.strokeRect(margin,margin,canvas.width-margin*2,canvas.height-margin*2);
  return margin;
}

async function loadImage(file){
  const img=new Image();
  img.crossOrigin="anonymous";
  img.src=BASE_RAW + encodeURIComponent(file);

  await new Promise((res,rej)=>{
    img.onload=res;
    img.onerror=rej;
  });

  clearWhite();
  const margin=drawBorder();

  // ðŸ”¥ FIXED UNIFORM BOX SIZE
  const BOX_WIDTH = 900;
  const BOX_HEIGHT = 1300;

  const boxX = (canvas.width - BOX_WIDTH)/2;
  const boxY = (canvas.height - BOX_HEIGHT)/2;

  // COVER MODE (always same size, crops evenly)
  const scale = Math.max(
    BOX_WIDTH / img.naturalWidth,
    BOX_HEIGHT / img.naturalHeight
  );

  const drawW = img.naturalWidth * scale;
  const drawH = img.naturalHeight * scale;

  const dx = boxX + (BOX_WIDTH - drawW)/2;
  const dy = boxY + (BOX_HEIGHT - drawH)/2;

  ctx.save();
  ctx.beginPath();
  ctx.rect(boxX, boxY, BOX_WIDTH, BOX_HEIGHT);
  ctx.clip(); // crop overflow
  ctx.drawImage(img, dx, dy, drawW, drawH);
  ctx.restore();
}

document.getElementById("btnLoad")
.addEventListener("click",()=>loadImage(picker.value));

document.getElementById("btnRandom")
.addEventListener("click",()=>{
  const r=FILES[Math.floor(Math.random()*FILES.length)];
  picker.value=r;
  loadImage(r);
});

document.getElementById("btnDownload")
.addEventListener("click",()=>{
  const a=document.createElement("a");
  a.download="colouring.png";
  a.href=canvas.toDataURL("image/png");
  a.click();
});

document.getElementById("btnPrint")
.addEventListener("click",()=>{
  const w=window.open("");
  w.document.write(`
    <img src="${canvas.toDataURL("image/png")}" style="width:100%">
    <script>window.onload=()=>window.print()<\/script>
  `);
  w.document.close();
});

loadImage(picker.value);
</script>

</body>
</html>

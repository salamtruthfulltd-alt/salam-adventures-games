<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>Magic Tap Ultra</title>
  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
    body { 
      margin: 0; padding: 15px; background: #94a3b8; 
      display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden;
    }

    /* THE CHUNKY 3D CASE */
    .toy {
      width: 100%; max-width: 900px; height: 90vh;
      background: #f8fafc; border-radius: 50px;
      padding: 15px; border: 8px solid #3b82f6;
      box-shadow: 0 20px 0 #1e4ed8, 0 30px 50px rgba(0,0,0,0.3);
      display: flex; flex-direction: column; position: relative;
    }

    /* THE SCREEN AREA */
    .screen {
      background: white; border-radius: 35px; flex: 1;
      display: flex; flex-direction: column; overflow: hidden;
      box-shadow: inset 0 10px 20px rgba(0,0,0,0.2);
    }

    .header { padding: 15px; border-bottom: 2px solid #eee; display: flex; justify-content: space-between; }
    
    /* THE ART */
    .view { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; }
    svg { width: 100%; height: 100%; max-height: 50vh; }
    .p { fill: #fff; stroke: #1e293b; stroke-width: 4; stroke-linejoin: round; cursor: pointer; }

    /* THE COLORS */
    .tray { background: #e2e8f0; padding: 15px; display: flex; flex-direction: column; gap: 10px; border-radius: 0 0 35px 35px; }
    .swatches { display: flex; gap: 8px; justify-content: center; overflow-x: auto; padding: 5px; }
    .swatch { 
      min-width: 50px; height: 50px; border-radius: 15px; border: 4px solid white; 
      cursor: pointer; box-shadow: 0 5px 0 #94a3b8;
    }
    .swatch.active { transform: translateY(3px); box-shadow: 0 2px 0 #94a3b8; border-color: #000; }

    .btn { 
      padding: 12px 20px; border: none; border-radius: 15px; font-weight: bold; 
      background: #3b82f6; color: white; cursor: pointer; box-shadow: 0 4px 0 #1e4ed8;
    }
    .btn:active { transform: translateY(2px); box-shadow: 0 2px 0 #1e4ed8; }

    #menu { position: absolute; inset: 0; background: white; z-index: 100; padding: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; overflow-y: auto; }
    .hidden { display: none !important; }
  </style>
</head>
<body>

<div class="toy">
  <div class="screen">
    <div class="header">
      <b style="font-size: 20px; color: #3b82f6;">MAGIC TAP PRO</b>
      <button class="btn" onclick="openMenu()">IMAGES</button>
    </div>

    <div id="menu" class="hidden"></div>
    <div class="view" id="view"></div>

    <div class="tray">
      <div class="swatches" id="pal"></div>
      <div style="display:flex; gap:10px; justify-content: center;">
        <button class="btn" onclick="resetArt()" style="background:#64748b; box-shadow: 0 4px 0 #334155;">CLEAR</button>
        <button class="btn" onclick="toggleAudio()" id="m-btn">MUSIC: OFF</button>
      </div>
    </div>
  </div>
</div>

<script>
  const COLORS = ['#FF4B4B', '#FF9F43', '#FECA57', '#1DD1A1', '#48DBFB', '#54A0FF', '#5F27CD', '#FF9FF3', '#222f3e', '#FFFFFF'];
  let pen = COLORS[0], aCtx = null, mus = false;

  const SCENES = [
    { name: "Garden", svg: `
      <path class="p" d="M50 550 h700 v-50 h-700 z"/>
      <path class="p" d="M380 400 h40 v150 h-40 z"/>
      <circle class="p" cx="400" cy="250" r="70"/>
      <path class="p" d="M400 180 q50-80 100 0 t-100 70 q-50-70-100 0 t100-70"/>
      <path class="p" d="M470 250 q80-50 80 50 t-80 50 q-80-50-80-50 t80-50"/>
      <circle class="p" cx="150" cy="100" r="40"/>
    `},
    { name: "Sea", svg: `
      <path class="p" d="M200 350 q150-200 400 0 t-400 200 t400-200 v150 l-150-150 z"/>
      <circle class="p" cx="300" cy="320" r="20"/>
      <circle class="p" cx="150" cy="150" r="15"/>
      <circle class="p" cx="100" cy="100" r="25"/>
      <path class="p" d="M100 500 q50-100 100 0 v100 h-100 z"/>
    `},
    { name: "Castle", svg: `
      <path class="p" d="M200 500 h400 v-200 h-400 z"/>
      <path class="p" d="M220 300 v-150 h80 v150 z"/>
      <path class="p" d="M500 300 v-150 h80 v150 z"/>
      <path class="p" d="M350 500 v-120 h100 v120 z"/>
      <path class="p" d="M210 150 l45-60 l45 60 z"/>
      <path class="p" d="M490 150 l45-60 l45 60 z"/>
    `},
    { name: "Rocket", svg: `
      <path class="p" d="M400 50 q120 150 120 450 h-240 q0-300 120-450"/>
      <circle class="p" cx="400" cy="220" r="50"/>
      <path class="p" d="M280 480 l-100 100 h100 z"/>
      <path class="p" d="M520 480 l100 100 h-100 z"/>
      <path class="p" d="M150 100 l20-20 l20 20 l-20 20 z"/>
      <path class="p" d="M700 200 l10-10 l10 10 l-10 10 z"/>
      <path class="p" d="M600 50 l30-30 l30 30 l-30 30 z"/>
    `}
  ];

  function start() {
    const pal = document.getElementById('pal');
    COLORS.forEach(c => {
      const s = document.createElement('div');
      s.className = 'swatch' + (c === pen ? ' active' : '');
      s.style.backgroundColor = c;
      s.onclick = () => {
        document.querySelectorAll('.swatch').forEach(x => x.classList.remove('active'));
        s.classList.add('active');
        pen = c;
      };
      pal.appendChild(s);
    });

    const menu = document.getElementById('menu');
    SCENES.forEach((s, i) => {
      const c = document.createElement('div');
      c.style.cssText = "border:2px solid #ddd; border-radius:20px; padding:10px; text-align:center;";
      c.innerHTML = `<svg viewBox="0 0 800 600">${s.svg}</svg><b>${s.name}</b>`;
      c.onclick = () => load(i);
      menu.appendChild(c);
    });
    load(0);
  }

  function load(idx) {
    const v = document.getElementById('view');
    v.innerHTML = `<svg viewBox="0 0 800 600" id="art">${SCENES[idx].svg}</svg>`;
    document.getElementById('menu').classList.add('hidden');
    v.querySelectorAll('.p').forEach(p => {
      p.onclick = (e) => { e.stopPropagation(); p.style.fill = pen; };
    });
  }

  function openMenu() { document.getElementById('menu').classList.remove('hidden'); }
  function resetArt() { document.querySelectorAll('#art .p').forEach(p => p.style.fill = "#fff"); }

  function toggleAudio() {
    if (!aCtx) aCtx = new (window.AudioContext || window.webkitAudioContext)();
    mus = !mus;
    document.getElementById('m-btn').innerText = mus ? "MUSIC: ON" : "MUSIC: OFF";
    if (mus) loop();
  }

  function loop() {
    if (!mus) return;
    const o = aCtx.createOscillator();
    const g = aCtx.createGain();
    o.frequency.value = [261, 329, 392, 523][Math.floor(Math.random()*4)];
    g.gain.setValueAtTime(0.1, aCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.01, aCtx.currentTime + 1);
    o.connect(g); g.connect(aCtx.destination);
    o.start(); o.stop(aCtx.currentTime + 1);
    setTimeout(loop, 1000);
  }

  start();
</script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <title>Neon Pulse: HUD Edition</title>
    <style>
        :root { --neon: #00f2ff; --pink: #ff00de; --gold: #ffcc00; --bg: #050505; }
        body { background: var(--bg); color: white; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; overflow: hidden; }

        /* --- THE NEW CYBER HUD BORDER --- */
        #game-frame {
            position: relative;
            padding: 30px;
            background: rgba(10, 10, 10, 0.9);
            border: 1px solid rgba(0, 242, 255, 0.2); /* Faint main border */
            width: 400px;
        }

        /* Animated Corners */
        .corner { position: absolute; width: 30px; height: 30px; border: 4px solid var(--neon); animation: cornerGlow 2s infinite; }
        .top-left { top: -5px; left: -5px; border-right: none; border-bottom: none; }
        .top-right { top: -5px; right: -5px; border-left: none; border-bottom: none; }
        .bottom-left { bottom: -5px; left: -5px; border-right: none; border-top: none; }
        .bottom-right { bottom: -5px; right: -5px; border-left: none; border-top: none; }

        @keyframes cornerGlow {
            0%, 100% { filter: drop-shadow(0 0 2px var(--neon)); opacity: 1; }
            50% { filter: drop-shadow(0 0 10px var(--pink)); border-color: var(--pink); opacity: 0.7; }
        }

        /* Moving Scanline */
        #scanline {
            position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(0, 242, 255, 0.1);
            box-shadow: 0 0 10px var(--neon);
            animation: scan 4s linear infinite;
            pointer-events: none; z-index: 5;
        }
        @keyframes scan { 0% { top: 0%; } 100% { top: 100%; } }

        /* --- UI ELEMENTS --- */
        .stats { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        #target-zone { height: 150px; border: 2px dashed #333; position: relative; display: flex; align-items: center; justify-content: center; margin: 20px 0; overflow: hidden; }
        #pulse { width: 40px; height: 40px; border: 4px solid var(--pink); border-radius: 50%; position: absolute; transform: scale(0); }
        .hit-ring { width: 50px; height: 50px; border: 2px solid var(--neon); border-radius: 50%; position: absolute; }

        /* Victory Overlay */
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
        .stars { font-size: 3rem; color: var(--gold); }
        .btn { background: var(--neon); color: black; border: none; padding: 15px 30px; font-weight: bold; cursor: pointer; text-transform: uppercase; width: 100%; margin-top: 10px; }
        
        table { width: 100%; font-size: 0.7rem; color: #777; margin-top: 20px; }
    </style>
</head>
<body onload="drawScores()">

<div id="game-frame">
    <div class="corner top-left"></div>
    <div class="corner top-right"></div>
    <div class="corner bottom-left"></div>
    <div class="corner bottom-right"></div>
    <div id="scanline"></div>

    <div class="stats">
        <div>⏳ <span id="timer">60</span>s</div>
        <div style="color:var(--gold)">SCORE: <span id="score">0</span></div>
    </div>

    <div id="target-zone" onclick="attemptHit()">
        <div class="hit-ring"></div>
        <div id="pulse"></div>
        <div id="msg" style="z-index:10; font-size: 0.8rem; color: #555;">TAP WHEN PINK HITS RING</div>
    </div>

    <div id="overlay">
        <div class="stars" id="star-display"></div>
        <h2 id="status-msg" style="color:var(--gold)">LEVEL COMPLETE</h2>
        <button class="btn" onclick="nextLevel()">CONTINUE</button>
    </div>

    <button id="start-btn" class="btn" onclick="startGame()">INITIALIZE HUD</button>

    <table id="leaderboard">
        <thead><tr><th>RANK</th><th>ID</th><th>PTS</th></tr></thead>
        <tbody id="score-body"></tbody>
    </table>
</div>

<script>
    let game = { score: 0, level: 1, timeLeft: 60, active: false, pulseScale: 0, speed: 0.03 };
    let clock, anim;

    function startGame() {
        game = { score: 0, level: 1, timeLeft: 60, active: true, pulseScale: 0, speed: 0.03 + (game.level * 0.01) };
        document.getElementById('start-btn').style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('score').innerText = "0";
        if(clock) clearInterval(clock);
        clock = setInterval(tick, 1000);
        runPulse();
    }

    function tick() {
        game.timeLeft--;
        document.getElementById('timer').innerText = game.timeLeft;
        if(game.timeLeft <= 0) endGame();
    }

    function runPulse() {
        if(!game.active) return;
        game.pulseScale += game.speed;
        if(game.pulseScale > 2) game.pulseScale = 0; // Loop pulse

        document.getElementById('pulse').style.transform = `scale(${game.pulseScale})`;
        anim = requestAnimationFrame(runPulse);
    }

    function attemptHit() {
        if(!game.active) return;
        
        // Perfect hit is when scale is close to 1.25 (the size of the ring)
        let diff = Math.abs(game.pulseScale - 1.25);
        
        if(diff < 0.2) {
            game.score += 100;
            document.getElementById('score').innerText = game.score;
            document.getElementById('target-zone').style.borderColor = 'var(--neon)';
            setTimeout(() => document.getElementById('target-zone').style.borderColor = '#333', 100);
            game.pulseScale = 0; // Reset pulse on hit
            
            if(game.score >= (game.level * 1000)) showVictory();
        } else {
            game.timeLeft -= 2; // Penalty for missing
        }
    }

    function showVictory() {
        game.active = false;
        cancelAnimationFrame(anim);
        document.getElementById('overlay').style.display = 'flex';
        
        let stars = "★";
        if(game.timeLeft > 20) stars = "★ ★";
        if(game.timeLeft > 40) stars = "★ ★ ★";
        document.getElementById('star-display').innerText = stars;
    }

    function nextLevel() {
        game.level++;
        game.score = 0;
        startGame();
    }

    function endGame() {
        game.active = false;
        clearInterval(clock);
        let name = prompt("HUD OFFLINE. Final Score: " + game.score + "\nEnter Callsign:");
        if(name) saveScore(name, game.score);
        location.reload();
    }

    function saveScore(n, s) {
        let b = JSON.parse(localStorage.getItem('hud_scores') || '[]');
        b.push({n: n.toUpperCase().substring(0,8), s: s});
        b.sort((a,b) => b.s - a.s);
        localStorage.setItem('hud_scores', JSON.stringify(b.slice(10)));
    }

    function drawScores() {
        let b = JSON.parse(localStorage.getItem('hud_scores') || '[]');
        document.getElementById('score-body').innerHTML = b.map((x, i) => 
            `<tr><td>#${i+1}</td><td>${x.n}</td><td>${x.s}</td></tr>`).join('');
    }
</script>
</body>
</html>

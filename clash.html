<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cyber Challenge Arcade</title>
    <style>
        :root { --neon: #00f2ff; --pink: #ff00de; --gold: #ffcc00; --bg: #0a0a0a; }
        body { background: var(--bg); color: white; font-family: 'Courier New', Courier, monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        
        /* The Flashing Border */
        #game-box {
            border: 6px solid var(--neon);
            padding: 20px; border-radius: 15px; background: #151515;
            text-align: center; width: 420px; position: relative;
            animation: borderGlow 2s infinite;
        }
        @keyframes borderGlow {
            0%, 100% { border-color: var(--neon); box-shadow: 0 0 20px var(--neon); }
            50% { border-color: var(--pink); box-shadow: 0 0 40px var(--pink); }
        }

        .stats { display: flex; justify-content: space-around; margin: 15px 0; background: #000; padding: 10px; border-radius: 8px; border: 1px solid #333; }
        .timer-alert { color: red; font-weight: bold; animation: pulse 0.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } }

        .btn { cursor: pointer; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; transition: 0.2s; }
        #bonus-btn { background: var(--gold); color: black; margin: 10px; }
        #bonus-btn:disabled { background: #555; cursor: not-allowed; }

        #display-area { min-height: 200px; padding: 20px; border: 1px inset #222; background: #000; margin-bottom: 20px; }
        .color-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .color-choice { height: 60px; border: 2px solid white; border-radius: 5px; cursor: pointer; font-size: 1rem; font-weight: bold; }

        table { width: 100%; font-size: 0.8rem; border-collapse: collapse; margin-top: 10px; }
        th { color: var(--neon); border-bottom: 1px solid #444; }
        td { padding: 5px; border-bottom: 1px solid #222; }
    </style>
</head>
<body onload="renderScores()">

<div id="game-box">
    <h2 id="level-title">LEVEL 1: MATH</h2>
    
    <div class="stats">
        <div>‚è≥ <span id="time-left">30</span>s</div>
        <div>üèÜ <span id="score">0</span>/5</div>
    </div>

    <button id="bonus-btn" onclick="useSkip()">‚òÖ SKIP QUESTION ‚òÖ</button>

    <div id="display-area">
        <div id="game-content">
            <h3 style="color:var(--neon)">READY?</h3>
            <button class="btn" style="background:var(--neon); font-size: 1.2rem;" onclick="initGame()">START MISSION</button>
        </div>
    </div>

    <div id="leaderboard">
        <strong>RANKING (TOP 10)</strong>
        <table id="score-table">
            <thead><tr><th>#</th><th>NAME</th><th>LVL</th></tr></thead>
            <tbody id="score-body"></tbody>
        </table>
    </div>
</div>

<script>
    let score = 0, level = 1, timeLeft = 30, goal = 5, timer = null;
    let currentSolution = "";
    const colorNames = ["RED", "BLUE", "GREEN", "YELLOW"];
    const hexCodes = ["#FF3131", "#3131FF", "#31FF31", "#FFFF31"];

    // BEEP GENERATOR (No 404s!)
    function sound(freq, type="sine", vol=0.1) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = type;
        osc.frequency.value = freq;
        g.gain.setValueAtTime(vol, ctx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.5);
        osc.connect(g); g.connect(ctx.destination);
        osc.start(); osc.stop(ctx.currentTime + 0.5);
    }

    function initGame() {
        score = 0; level = 1; timeLeft = 30; goal = 5;
        document.getElementById('bonus-btn').disabled = false;
        loadChallenge();
        if(timer) clearInterval(timer);
        timer = setInterval(countDown, 1000);
    }

    function countDown() {
        timeLeft--;
        const timerEl = document.getElementById('time-left');
        timerEl.innerText = timeLeft;
        if(timeLeft <= 5) {
            timerEl.classList.add('timer-alert');
            sound(150, "square", 0.05); // Alarm beep
        }
        if(timeLeft <= 0) endGame();
    }

    function loadChallenge() {
        const area = document.getElementById('game-content');
        document.getElementById('score').innerText = score;
        document.getElementById('time-left').classList.remove('timer-alert');

        if(level === 1) {
            document.getElementById('level-title').innerText = "LVL 1: MATH";
            let a = Math.floor(Math.random() * 9) + 2;
            let b = Math.floor(Math.random() * 9) + 2;
            currentSolution = a * b;
            area.innerHTML = `<h3>Solve Fast!</h3><h1 style="font-size:3rem">${a} x ${b}</h1>
                              <input type="number" id="input" autofocus onkeydown="if(event.key==='Enter') verify()">`;
            document.getElementById('input').focus();
        } else {
            document.getElementById('level-title').innerText = "LVL 2: COLOR CLASH";
            document.getElementById('level-title').style.color = "var(--pink)";
            
            let textIdx = Math.floor(Math.random() * 4);
            let colorIdx = Math.floor(Math.random() * 4);
            if(textIdx === colorIdx) colorIdx = (colorIdx + 1) % 4;
            
            currentSolution = colorNames[colorIdx];
            area.innerHTML = `<h3>Click the COLOR you SEE:</h3>
                              <h1 style="color:${hexCodes[colorIdx]}; font-size:3.5rem; margin:10px;">${colorNames[textIdx]}</h1>
                              <div class="color-grid">
                                ${colorNames.map((c, i) => `<button class="color-choice" style="background:${hexCodes[i]}" onclick="verify('${c}')">${c}</button>`).join('')}
                              </div>`;
        }
    }

    function verify(choice) {
        let userAns = choice || document.getElementById('input').value;
        if(userAns.toString().toUpperCase() == currentSolution) {
            score++;
            sound(600);
            if(score >= goal) levelUp(); else loadChallenge();
        } else {
            sound(100, "sawtooth");
            if(level === 1) document.getElementById('input').value = "";
        }
    }

    function levelUp() {
        level++;
        score = 0;
        goal = 8;
        timeLeft += 10;
        sound(800);
        alert("LEVEL CLEAR! Time Added.");
        loadChallenge();
    }

    function useSkip() {
        document.getElementById('bonus-btn').disabled = true;
        score++;
        sound(1000);
        if(score >= goal) levelUp(); else loadChallenge();
    }

    function endGame() {
        clearInterval(timer);
        sound(50, "square", 0.3);
        let name = prompt(`GAME OVER! You reached Level ${level}. Name:`);
        if(name) saveScore(name, level);
        document.getElementById('game-content').innerHTML = `<h3>Time Up!</h3><button class="btn" style="background:var(--pink)" onclick="initGame()">RETRY</button>`;
    }

    function saveScore(n, l) {
        let s = JSON.parse(localStorage.getItem('scores') || '[]');
        s.push({n: n.slice(0,10), l: l});
        s.sort((a,b) => b.l - a.l);
        localStorage.setItem('scores', JSON.stringify(s.slice(0,10)));
        renderScores();
    }

    function renderScores() {
        let s = JSON.parse(localStorage.getItem('scores') || '[]');
        document.getElementById('score-body').innerHTML = s.map((x, i) => `<tr><td>${i+1}</td><td>${x.n}</td><td>${x.l}</td></tr>`).join('');
    }
</script>
</body>
</html>

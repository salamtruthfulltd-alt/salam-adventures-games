<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Salam Adventures | Fun Puzzle Game</title>
  <style>
    :root{
      --bg:#0b1220;
      --card: rgba(255,255,255,.06);
      --card2: rgba(0,0,0,.28);
      --line: rgba(255,255,255,.12);
      --text:#e9f2ff;
      --muted:#b9c7e6;
      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --good:#62ffcf;
      --warn:#fbbf24;
      --pink:#fb7185;
      --blue:#60a5fa;
      --purple:#a78bfa;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 10%, #203a7a 0%, var(--bg) 55%, #070b14 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:12px;
    }

    /* ===== APP SIZE (SMALL + EMBED FRIENDLY) ===== */
    .wrap{
      width:min(980px, 100%);
      margin:auto;
    }

    .topbar{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:center;
      margin-bottom:12px;
    }

    .btn{
      border:none;border-radius:16px;
      padding:10px 14px;
      cursor:pointer;
      font-weight:900;
      letter-spacing:.2px;
      color:#09101e;
      box-shadow:var(--shadow);
      display:flex;align-items:center;gap:10px;
      user-select:none;
      transition:transform .08s ease, filter .2s ease;
      background: linear-gradient(135deg,#60a5fa,#34d399);
      font-size:14px;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);filter:brightness(1.06)}
    .btn:active{transform:translateY(0) scale(.99)}
    .btn .e{font-size:18px;line-height:1}
    .btn.secondary{background:linear-gradient(135deg,#a78bfa,#60a5fa)}
    .btn.warn{background:linear-gradient(135deg,#fbbf24,#fb7185)}
    .btn.dark{
      background:rgba(255,255,255,.08);
      color:var(--text);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.12), 0 10px 30px rgba(0,0,0,.35);
    }
    .btn.active{outline:3px solid rgba(98,255,207,.92);outline-offset:2px}

    .stage{
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      padding:12px;
      overflow:hidden;
    }

    /* ===== SIDE BY SIDE BOARD + TRAY ===== */
    .grid{
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    .left{flex:1 1 auto; min-width:0;}
    .right{flex:0 0 340px; min-width:0;}
    @media (max-width: 860px){
      .grid{flex-direction:column;}
      .right{flex:1 1 auto; width:100%;}
    }

    /* ===== BOARD CARD ===== */
    .card{
      border-radius:20px;
      background: var(--card2);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }

    .cardHead{
      padding:10px 12px;
      display:flex;flex-wrap:wrap;gap:10px;
      align-items:center;justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: linear-gradient(90deg, rgba(34,197,94,.14), rgba(59,130,246,.12), rgba(168,85,247,.10));
    }

    .chip{
      font-size:12px;padding:6px 10px;border-radius:999px;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.12);
      color:var(--muted);
      display:inline-flex;align-items:center;gap:8px;
    }
    .kbd{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size:11px;padding:3px 7px;border-radius:8px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);color:#cfe0ff;
    }

    .boardWrap{
      padding:12px;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    /* ===== BOARD (drop targets) ===== */
    .board{
      width:min(560px, 100%);
      aspect-ratio: 3 / 2; /* 3x2 looks perfect; 2x2 still fits */
      border-radius:18px;
      background: #ffffff;
      position:relative;
      overflow:hidden;

      /* fancy 3D border */
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.16),
        0 18px 40px rgba(0,0,0,.35);
    }

    /* faint preview image (hint) */
    .preview{
      position:absolute;inset:0;
      background-size:cover;
      background-position:center;
      filter: grayscale(1) contrast(1.05);
      opacity:.20;
      pointer-events:none;
    }

    .cells{
      position:absolute; inset:0;
      display:grid;
      gap:6px;
      padding:10px;
    }

    .cell{
      border-radius:14px;
      border:2px dashed rgba(0,0,0,.18);
      background: rgba(255,255,255,.35);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      overflow:hidden;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }

    .cell.over{
      border-color: rgba(96,165,250,.75);
      background: rgba(96,165,250,.10);
      transform: scale(1.01);
    }

    .cell.filled{
      border-style:solid;
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.06);
    }

    /* ===== TRAY ===== */
    .trayBody{padding:12px;}
    .trayGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    @media (max-width: 860px){
      .trayGrid{grid-template-columns: repeat(4, 1fr);}
    }

    /* ===== PIECES ===== */
    .piece{
      width:100%;
      aspect-ratio:1/1;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background-color:#fff;
      background-repeat:no-repeat;
      background-size: var(--bgSize, 100% 100%);
      background-position: var(--bgPos, center);
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.10),
        0 10px 18px rgba(0,0,0,.35);
      cursor:grab;
      position:relative;
      transform: translateZ(0);
      transition: transform .08s ease, filter .15s ease;
    }
    .piece:active{cursor:grabbing; transform: scale(.98);}
    .piece.dragging{opacity:.65; filter:brightness(1.05);}

    /* ===== PIECE ON BOARD SHOULD FIT CELL EXACTLY ===== */
    .cell .piece{
      width:100%;
      height:100%;
      aspect-ratio:auto;
      border-radius:12px;
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.10),
        0 10px 16px rgba(0,0,0,.25);
    }

    /* ===== STATUS / TOAST ===== */
    .statusBar{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      color:var(--muted);
      font-size:12px;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);

<!DOCTYPE html>
<html>
<head>
    <title>Cyber Math: 60s Sprint</title>
    <style>
        :root { --neon: #00f2ff; --pink: #ff00de; --gold: #ffcc00; --bg: #0a0a0a; }
        body { background: var(--bg); color: white; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        
        #game-box { border: 6px solid var(--neon); padding: 20px; border-radius: 20px; background: #111; text-align: center; width: 450px; position: relative; animation: flash 2s infinite alternate; }
        @keyframes flash { from { border-color: var(--neon); } to { border-color: var(--pink); } }

        .stats { display: flex; justify-content: space-around; background: #000; padding: 10px; border-radius: 10px; border: 1px solid #333; font-size: 1.1rem; margin-bottom: 10px; }
        .score-text { color: var(--gold); font-weight: bold; font-size: 1.4rem; }
        
        #screen { min-height: 250px; background: #000; border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; margin-bottom: 15px; border: 1px inset #222; position: relative; overflow: hidden; }
        
        /* Victory Screen */
        #victory-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .stars { font-size: 3.5rem; color: var(--gold); margin-bottom: 10px; animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }

        input { font-size: 3rem; width: 180px; text-align: center; background: #000; color: var(--neon); border: 2px solid var(--pink); border-radius: 10px; outline: none; margin-top: 10px; }
        .btn { cursor: pointer; border: none; padding: 15px; border-radius: 8px; font-weight: bold; background: var(--neon); color: black; width: 100%; font-size: 1.1rem; }
        
        #leaderboard { width: 100%; margin-top: 15px; font-size: 0.8rem; border-top: 1px solid #333; padding-top: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th { color: var(--neon); text-align: left; }
    </style>
</head>
<body onload="updateBoard()">

<div id="game-box">
    <h2 id="lvl-display" style="margin:0">LEVEL 1: ADDITION</h2>
    
    <div class="stats">
        <div>⏳ <span id="timer">60</span>s</div>
        <div class="score-text">PTS: <span id="points">0</span></div>
    </div>

    <div id="screen">
        <div id="victory-screen">
            <div class="stars">★ ★ ★</div>
            <h2 id="vic-msg" style="color:var(--gold); margin:0;">TIME UP!</h2>
            <p id="vic-score" style="margin:10px 0;">Points Earned: 0</p>
            <button class="btn" style="width: 80%; background:var(--gold)" onclick="nextLevel()">START NEXT LEVEL</button>
        </div>

        <div id="content">
            <button class="btn" onclick="startRound()">START 60s SPRINT</button>
        </div>
    </div>

    <button id="bonus-btn" class="btn" style="background:var(--gold); margin-top:10px;" onclick="skip()" disabled>★ BONUS SKIP ★</button>

    <div id="leaderboard">
        <table>
            <thead><tr><th>RANK</th><th>PILOT</th><th>TOTAL POINTS</th></tr></thead>
            <tbody id="score-body"></tbody>
        </table>
    </div>
</div>

<script>
    let game = {
        lvl: 1,
        score: 0,
        totalScore: 0,
        timeLeft: 60,
        ans: 0,
        active: false
    };
    let ticker = null;

    function startRound() {
        game.score = 0;
        game.timeLeft = 60;
        game.active = true;
        document.getElementById('points').innerText = "0";
        document.getElementById('bonus-btn').disabled = false;
        document.getElementById('victory-screen').style.display = 'none';
        
        if(ticker) clearInterval(ticker);
        ticker = setInterval(countDown, 1000);
        newProblem();
    }

    function countDown() {
        game.timeLeft--;
        document.getElementById('timer').innerText = game.timeLeft;
        if(game.timeLeft <= 0) endRound();
    }

    function newProblem() {
        const area = document.getElementById('content');
        let a, b, op;
        
        // Level Logic
        if(game.lvl === 1) { op = '+'; a = rand(2, 20); b = rand(2, 20); }
        else if(game.lvl === 2) { op = '-'; a = rand(10, 30); b = rand(2, 10); }
        else if(game.lvl === 3) { op = Math.random() > 0.5 ? '+' : '-'; a = rand(10, 40); b = rand(10, 40); }
        else if(game.lvl === 4) { op = '/'; b = rand(2, 10); a = b * rand(2, 10); } // Division always whole numbers
        else { 
            let ops = ['+', '-', '*', '/'];
            op = ops[Math.min(game.lvl - 5, 3)]; 
            if(op === '/') { b = rand(2, 12); a = b * rand(2, 12); }
            else if(op === '*') { a = rand(2, 12); b = rand(2, 10); }
            else { a = rand(10, 100); b = rand(10, 100); }
        }

        game.ans = eval(`${a}${op}${b}`);
        area.innerHTML = `<h3>Solve:</h3><h1>${a} ${op === '*' ? '×' : op === '/' ? '÷' : op} ${b}</h1>
                          <input type="number" id="box" onkeydown="if(event.key==='Enter') check()">`;
        setTimeout(() => document.getElementById('box').focus(), 10);
    }

    function check() {
        if(!game.active) return;
        let input = document.getElementById('box').value;
        if(input == game.ans) {
            game.score += 100;
            document.getElementById('points').innerText = game.score;
            newProblem();
        } else {
            document.getElementById('box').value = "";
        }
    }

    function skip() {
        if(!game.active) return;
        game.score += 100;
        document.getElementById('points').innerText = game.score;
        document.getElementById('bonus-btn').disabled = true;
        newProblem();
    }

    function endRound() {
        game.active = false;
        clearInterval(ticker);
        game.totalScore += game.score;
        
        document.getElementById('victory-screen').style.display = 'flex';
        document.getElementById('vic-score').innerText = `Level Points: ${game.score} | Total: ${game.totalScore}`;
    }

    function nextLevel() {
        if(game.lvl < 10) {
            game.lvl++;
            document.getElementById('lvl-display').innerText = `LEVEL ${game.lvl}: ${getLvlName()}`;
            startRound();
        } else {
            let name = prompt("ALL LEVELS CLEAR! Enter your name:");
            if(name) save(name, game.totalScore);
            location.reload();
        }
    }

    function getLvlName() {
        let names = ["ADDITION", "SUBTRACTION", "MIXED +-", "DIVISION", "MULTIPLICATION", "ALGEBRA LITE", "CHALLENGE 1", "CHALLENGE 2", "CHALLENGE 3", "THE GAUNTLET"];
        return names[game.lvl - 1];
    }

    function rand(min, max) { return Math.floor(Math.random() * (max - min + 1) + min); }

    function save(n, s) {
        let h = JSON.parse(localStorage.getItem('math_sprint') || '[]');
        h.push({n: n.substring(0,10).toUpperCase(), s: s});
        h.sort((a,b) => b.s - a.s);
        localStorage.setItem('math_sprint', JSON.stringify(h.slice(0,10)));
        updateBoard();
    }

    function updateBoard() {
        let h = JSON.parse(localStorage.getItem('math_sprint') || '[]');
        document.getElementById('score-body').innerHTML = h.map((x, i) => `<tr><td>#${i+1}</td><td>${x.n}</td><td>${x.s}</td></tr>`).join('');
    }

    function gameOverMan() {
        // Simple manual reset for leaderboard testing
        let name = prompt("Session Finished! Enter Name:");
        if(name) save(name, game.totalScore);
        location.reload();
    }
</script>
</body>
</html>
